# stock_price
To forecast stock prices
Astock: A New Dataset and Automated Stock Trading based on Stock-specific News Analyzing Model
This is a platform with 3 main features-
(1)	We provide financial news for each specific stock. 
(2)	We provide various stock factors for each stock. 
(3)	We evaluate performance from more financial-relevant metrics.
The key to this algorithm is a method called semantic role labeling Pooling (SRLP), which leverages Semantic Role Labeling (SRL) to create a compact representation of each news paragraph.
The Platform is based on two novel techniques. One leverages Propbank-style semantic role labeling results to create compact news representation. Building on top of this representation, the other technique is a customized self-supervised learning training strategy for improving generalization performance.
Existing approaches are usually based on market sentiment analysis [Xu and Cohen, 2018; Cheng and Li, 2021] and use news to predict the related securities’ price on the following trading day(s) [Zhang et al., 2017; Li et al., 2020].
Firstly, previous methods ignore the financial factors, which plays a key role in practical trading. Secondly, these models are evaluated only on intermediate performance metric, e.g., stock movement prediction accuracy. It is unclear how well they can support a practical trading system to make sufficient profit.
Stock movement prediction was evaluated, and trading performance was simulated. For the Stock movement prediction, Accuracy, F1 Score, Recall and Precision were the evaluation metrics. For simulated trading, Annualized Rate of Return, Maximum Drawdown and Sharpe Ration were the evaluation metrics based on the simulated trading strategy.
The proposed method demonstrates superior performance over other baselines through extensive experiments in both in-distribution and out-of-distribution settings. Also, by feeding the prediction to a practical simulated trading, this method achieves better profitability in backtesting.

Deep Learning for Event-Driven Stock Prediction
First, events are extracted from news text, and represented as dense vectors, trained using a novel neural tensor network. Second, a deep convolutional neural network is used to model both short-term and long-term influences of events on stock price movements.
Recent work has applied Natural Language Processing (NLP) techniques to explore financial news for predicting market volatility. Pioneering work mainly uses simple features from news documents, such as bags-of-words, noun phrases, and named entities [Kogan et al., 2009; Schumaker and Chen, 2009]. Although useful, these features do not capture structured relations, which limits their potentials. Say we have Company A suing company B, the Unstructured cannot differentiate an accuser from a defendant and hence cannot accurately predict stock price movement.
To obtain structured events representations, we find that the actor and object of events can be better captured. Structured can classify Actor = Company A, Action = sues. Object = Company B and hence can accurately predict stock price movement. But structured could lead to increased sparsity. 
This issue has been addressed by representing structured events using event embeddings, which are dense vectors. Embeddings are trained such that similar events, have similar vectors, even if they do not share common words.
Event embeddings are trained using a novel neural tensor network (NTN), which can learn the semantic compositionality over event arguments by combining them multiplicatively instead of only implicitly, as with standard neural networks.
Old news might not have greater impact on volatility but still would have impact on the movement. Hence historic news is added as daily event sequences, using a convolutional neural network (CNN) to perform semantic composition over the input event sequence, and a pooling layer to extract the most representative global features.
In contrast to the baselines, a neural tensor network is used to learn event embeddings for representing news documents, and build a prediction model based on a deep CNN. To make detailed analysis, the following five models are constructed:
•	WB-NN: word embeddings input and standard neural network prediction model [Ding et al., 2014];
•	WB-CNN: word embeddings input and convolutional neural network prediction model (this paper);
•	E-CNN: structured events tuple [Ding et al., 2014] input and convolutional neural network prediction model (this paper); 
•	EB-NN: event embeddings input (this paper) and standard neural network prediction model [Ding et al., 2014];
•	EB-CNN: event embeddings input and convolutional neural network prediction model (this paper). A word embedding input (WB) consists of the sum of each word in a document; it addresses sparsity in word-based inputs, and can serve as a baseline embedding method. The standard feedforward neural network (NN) is used as a baseline to compare with the deep CNN.
Thus, Deep learning is useful for event-driven stock price movement prediction by proposing a novel neural tensor network for learning event embeddings, and using a deep convolutional neural network to model the combined influence of long-term events and short-term events on stock price movements
Experimental results showed that event embeddings-based document representations are better than discrete events-based methods, and deep convolutional neural network can capture longer-term influence of news event than standard feedforward neural network.
In market simulation, a simple greedy strategy allowed our model to yield more profit compared with previous work.

Stock Movement Prediction from Tweets and Historical Prices
This is a novel deep generative model jointly exploiting text and price signals for this task.
In natural language processing (NLP), public news and social media are two primary content resources for stock market prediction, and the models that use these sources are often discriminative.
Stock prices are largely driven by new information, resulting in a random-walk pattern (Malkiel, 1999). Instead of using only deterministic features, generative topic models were extended to jointly learn topics and sentiments for the task.
Compared to discriminative models, generative models have the natural advantage in depicting the generative process from market information to stock signals and introducing randomness. However, these models underrepresent chaotic social texts with bag-of-words and employ simple discrete latent variables.
In essence, stock movement prediction is a time series problem. The significance of the temporal dependency between movement predictions is not addressed in existing NLP research. For instance, when a company suffers from a major scandal on a trading day d1, generally, its stock price will have a downtrend in the coming trading days until day d2, i.e. [d1, d2]. 2 If a stock predictor can recognize this decline pattern, it is likely to benefit all the predictions of the movements during [d1, d2]. Otherwise, the accuracy in this interval might be harmed.
To fully exploit market information, StockNet directly learns from data without pre-extracting structured events. We build market sources by referring to both fundamental information, e.g. tweets, and technical features, e.g. historical stock prices.
To accurately depict predictive dependencies, it is assumed that the movement prediction for a stock can benefit from learning to predict its historical movements in a lag window. Trading-day alignment is proposed as the framework basis and further a novel multi-task learning objective is provided.
In a nutshell, StockNet comprises three primary components following a bottom-up fashion, 1. Market Information Encoder (MIE) that encodes tweets and prices to X; 2. Variational Movement Decoder (VMD) that infers Z with X, y and decodes stock movements y from X, Z; 3. Attentive Temporal Auxiliary (ATA) that integrates temporal loss through an attention mechanism for model training.
The standard measure of accuracy and Matthews Correlation Coefficient (MCC) are taken as evaluation metrics. MCC avoids bias due to data skew. Given the confusion matrix tp fn fp tn, containing the number of samples classified as true positive, false positive, true negative and false negative, MCC is calculated as MCC = tp × tn − fp × fn /sq.root(p (tp + fp)(tp + fn)(tn + fp)(tn + fn))
We demonstrated the effectiveness of deep generative approaches for stock movement prediction from social media data by introducing StockNet, a neural network architecture for this task. We tested our model on a new comprehensive dataset and showed it performs better than strong baselines, including implementation of previous work
